{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/sofi/Coding/task-managment-system/client/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { userLoginValidation } from '../helpers/formValidation';\nimport { postMethod } from '../helpers/request';\nimport { useHistory } from \"react-router-dom\";\n\nconst Login = () => {\n  _s();\n\n  const [loginErrorMsg, setLoginErrorMsg] = useState('');\n  let history = useHistory();\n  useEffect(() => {\n    if (window.localStorage.getItem('userId')) {\n      window.location.replace(\"/\");\n    }\n  });\n\n  const handleFormSubmit = async event => {\n    event.preventDefault();\n    console.log(5);\n    const form = document.querySelector('form');\n    let formData = Object.fromEntries(new FormData(form).entries());\n    const formValidation = userLoginValidation(formData);\n    const formValidationStatus = formValidation.code;\n\n    if (formValidationStatus != 200) {\n      return setLoginErrorMsg(formValidation.message);\n    }\n\n    const request = await postMethod(formData, '/api/users/login');\n    const requestData = request.data;\n\n    if (requestData.status == 200) {\n      // redirect to home\n      // set local storage cookie\n      setLoginErrorMsg('success');\n      const user = request.data.message;\n      const userId = user._id;\n      localStorage.setItem('userId', userId);\n      history.push('/home');\n    } else {\n      console.log(1); // redirect\n      // establish cookie/local storage\n\n      setLoginErrorMsg(requestData.message);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: loginErrorMsg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleFormSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          placeholder: \"a@a.com\",\n          value: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Password \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          value: \"11111111111\",\n          name: \"password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Login, \"DAdZjTDiBbtg5w6RTqPGAbIfIOg=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/sofi/Coding/task-managment-system/client/src/pages/Login.js"],"names":["React","useState","useEffect","userLoginValidation","postMethod","useHistory","Login","loginErrorMsg","setLoginErrorMsg","history","window","localStorage","getItem","location","replace","handleFormSubmit","event","preventDefault","console","log","form","document","querySelector","formData","Object","fromEntries","FormData","entries","formValidation","formValidationStatus","code","message","request","requestData","data","status","user","userId","_id","setItem","push"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { userLoginValidation } from '../helpers/formValidation'\nimport { postMethod } from '../helpers/request'\nimport { useHistory } from \"react-router-dom\";\n\nconst Login = () => {\n    const [ loginErrorMsg, setLoginErrorMsg ] = useState('')\n    let history = useHistory()\n\n    useEffect(() => {\n        if(window.localStorage.getItem('userId')) {\n            window.location.replace(\"/\")\n        }\n    })\n\n    const handleFormSubmit = async (event) => {\n        event.preventDefault()\n        console.log(5)\n        const form = document.querySelector('form')\n        let formData = Object.fromEntries(new FormData(form).entries())\n        const formValidation = userLoginValidation(formData)\n        const formValidationStatus = formValidation.code\n\n        if(formValidationStatus != 200) {\n            return setLoginErrorMsg(formValidation.message)\n        }\n\n        const request = await postMethod(formData, '/api/users/login')\n        const requestData = request.data\n\n        if(requestData.status == 200) {\n            // redirect to home\n            // set local storage cookie\n            setLoginErrorMsg('success')\n            const user = request.data.message\n            const userId = user._id\n\n            localStorage.setItem('userId', userId)\n            history.push('/home')\n        } else {\n            console.log(1)\n            // redirect\n            // establish cookie/local storage\n            setLoginErrorMsg(requestData.message)\n        }\n        \n    }\n\n    return (\n        <div>\n            <p>{loginErrorMsg}</p>\n            <form onSubmit={handleFormSubmit}>\n                <div>\n                    <label>Email</label>\n                    <input type=\"email\" name=\"email\" placeholder=\"a@a.com\" value=\"\" />\n                </div>\n\n                <div>\n                    <label>Password </label>\n                    <input type=\"password\" value=\"11111111111\" name=\"password\" />\n                </div>\n\n                <input type=\"submit\" />\n            </form>\n        </div>\n    )\n}\n\nexport default Login"]},"metadata":{},"sourceType":"module"}